---
applyTo: '**'
priority: 100
description: 'SECURITY STANDARDS.instructions - Auto-generated instruction set'
lastUpdated: '2025-10-28 15:43:11'
autoGenerated: true
---

# Security Standards & Guidelines

## Database Security (CRITICAL)
- Always use prepared statements with PDO
- Never concatenate user input into SQL queries
- Validate and sanitize ALL user input
- Use parameter binding for all dynamic queries

## Authentication & Authorization
- Implement CSRF protection on all forms
- Use secure session configuration
- Validate user permissions before data access
- Log all authentication attempts and failures

## Input/Output Security
- Escape all HTML output with htmlspecialchars()
- Validate file uploads (type, size, content)
- Sanitize file paths to prevent directory traversal
- Use proper Content-Type headers

## API Security
- Implement rate limiting on all endpoints
- Use API keys or OAuth for authentication
- Validate JSON input against schemas
- Return structured error responses (never raw errors)

## Environment Security
- Store secrets in .env files only
- Never commit credentials to version control
- Use HTTPS for all production traffic
- Implement proper CORS policies

## Logging & Monitoring
- Log security events with context
- Monitor for suspicious patterns
- Redact sensitive data from logs
- Implement audit trails for critical operations

## Code Review Checklist
- [ ] No hardcoded credentials or secrets
- [ ] All user input validated and sanitized
- [ ] SQL queries use prepared statements
- [ ] HTML output properly escaped
- [ ] Authentication checks in place
- [ ] Error handling doesn't expose internals
